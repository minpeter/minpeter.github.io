---
title: "ðŸª™ AWS - VPC"
description: "Virtual Private Cloudì— ëŒ€í•´ ì•Œì•„ë³´ìž!!"
date: 2022-06-16T03:03:07.156Z
tags: ["Subnet","aws","vpc"]
categories: "aws"
---
## ì´ë¡ 

### VPC (ê°€ìƒ ì‚¬ì„¤ í´ë¼ìš°ë“œ)
Virtual Private Cloudì˜ ì•½ìžë¡œ AWS ìƒì—ì„œ ë…¼ë¦¬ì ìœ¼ë¡œ ë…ë¦½ëœ ê³µê°„ì„ ì œê³µí•˜ì—¬ ë¦¬ì†ŒìŠ¤ë¥¼ ì‹¤í–‰í•  ìˆ˜ ìžˆê²Œ ë„ì›€

### VPCì˜ ì¢…ë¥˜

AWSì—ëŠ” ë¦¬ì „ ë³„ Default VPCì™€ Custom VPCê°€ ì¡´ìž¬í•œë‹¤.
Default VPCëŠ” ê° ë¦¬ì „ì— ê¸°ë³¸ì ìœ¼ë¡œ í•˜ë‚˜ì”© ìƒì„±ë˜ì–´ ìžˆê³ ,
Custom VPCëŠ” ë¦¬ì „ ë³„ë¡œ ìµœëŒ€ 5ê°œê¹Œì§€ ìƒì„±í•  ìˆ˜ ìžˆë‹¤.


### Subnet (ì„œë¸Œë„·)
ë„¤íŠ¸ì›Œí¬ ì˜ì—­ì„ ë‚˜ëˆˆ ë§
í´ë¼ìš°ë“œ í™˜ê²½ì˜ VPCì—ì„œë„ ì„œë¸Œë„·ì„ í†µí•´ ë„¤íŠ¸ì›Œí¬ë¥¼ ë¶„ë¦¬í•˜ì—¬ ë‚˜ëˆŒ ìˆ˜ ìžˆë‹¤.


#### ì„œë¸Œë„·ì—ì„œ ì˜ˆì•½ëœ IP ì£¼ì†Œ

ì„œë¸Œë„·ì— í• ë‹¹í•œ IP ëŒ€ì—­ì´ 10.0.0.0/24ë¼ë©´ 10.0.0.0 ~ 10.0.0.255 ì¤‘ì—ì„œ

| ì£¼ì†Œ | ì„¤ëª… |
| --- | --- |
| 10.0.0.0 | ë„¤íŠ¸ì›Œí¬ ì£¼ì†Œ |
| 10.0.0.1 | AWS VPC ê°€ìƒ ë¼ìš°í„° ì£¼ì†Œ |
| 10.0.0.2 | AWS DNS ì„œë²„ ì£¼ì†Œ |
| 10.0.0.3 | í–¥í›„ ìƒˆë¡œìš´ ê¸°ëŠ¥ì„ ìœ„í•´ ì˜ˆì•½ |
| 10.0.0.255 | ë„¤íŠ¸ì›Œí¬ ë¸Œë¡œë“œìºìŠ¤íŠ¸ ì£¼ì†Œ |

ë˜í•œ AWS Subnetì—ëŠ” Public Subnetê³¼ Private Subnetì´ ì¡´ìž¬í•œë‹¤.
Public Subnetì€ ì™¸ë¶€ ì¸í„°ë„·ê³¼ ì§ì ‘ì ì¸ í†µì‹ ì„ í•  ìˆ˜ ìžˆëŠ” ë„¤íŠ¸ì›Œí¬ì´ê³ ,
Private Subnetì€ ì™¸ë¶€ ì¸í„°ë„·ê³¼ ì§ì ‘ì ì¸ í†µì‹ ì„ í•  ìˆ˜ ì—†ëŠ” íŒ¨ì‡„ì ì¸ ë„¤íŠ¸ì›Œí¬ì´ë‹¤.
*ë‹¨ Private ì„œë¸Œë„·ì˜ ê²½ìš°ì—ë„ NAT ê²Œì´íŠ¸ì›¨ì´ê°€ ìžˆë‹¤ë©´ ì™¸ë¶€ì™€ì˜ í†µì‹ ì´ ê°€ëŠ¥í•˜ë‹¤.

### Security Groupê³¼ ACL

ì¸ìŠ¤í„´ìŠ¤ ë‹¨ê³„ì—ì„œ ë³´ì•ˆ ê¸°ìˆ ì€ Security Groupì´ë‹¤.
ì„œë¸Œë„·ì—ì„œ ì‚¬ìš©í•˜ëŠ” ë³´ì•ˆ ê¸°ìˆ ë„ ì¡´ìž¬í•˜ëŠ”ë° Access Control List (ACL)ì´ë‹¤.

## ì‹¤ìŠµ - Public Subnet VPC êµ¬ì„±
#### ì‹¤ìŠµ ë‹¨ê³„

| Public Subnet VPC ìƒì„± | ê²€ì¦ |
| --- | --- |
| VPC ìƒì„± | EC2 ì¸ìŠ¤í„´ìŠ¤ ìƒì„± |
| í¼ë¸”ë¦­ ì„œë¸Œë„· ìƒì„± | EC2 ì¸ìŠ¤í„´ìŠ¤ ì ‘ê·¼ í›„ í†µì‹  í™•ì¸ |
| ì¸í„°ë„· ê²Œì´íŠ¸ì›¨ì´ ìƒì„± ë° VPC ì—°ê²° | |
| í¼ë¸”ë¦­ ë¼ìš°íŒ… í…Œì´ë¸” ìƒì„± ë° ì„œë¸Œë„· ì—°ê²° | |
| í¼ë¸”ë¦­ ë¼ìš°íŒ… í…Œì´ë¸” ê²½ë¡œ ì¶”ê°€ | |


### VPC ìƒì„±
1. VPC Console ì ‘ì† -> VPC
![](/images/bbe6166b-3c0c-425b-bf37-c20789281d48-image.png)
2. ì´ë¦„: CloudPeter-VPC
IPv4 CIDR ë¸”ë¡: 10.0.0.0/16
![](/images/c910f84f-9e0b-46d1-93e1-a87fb3a031e2-image.png)
3. ìƒì„± í™•ì¸
![](/images/73329ad0-576c-4e66-9b2f-f8439c3e1998-image.png)
*ë‚˜ì¤‘ì— ê¸°ë³¸ VPCì™€ ì‚¬ìš©ìž VPCë¥¼ êµ¬ë¶„í• ë•Œ Name Tagì˜ ìœ ë¬´ë¥¼ í™•ì¸í•  ìˆ˜ ìžˆìŒ

### Public Subnet ìƒì„±

1. VPC Console ì ‘ì† -> ì„œë¸Œë„·
![](/images/3cd9199a-6553-4856-bed2-399a6ddf9b15-image.png)
2. VPC ID: ìƒì„±í•œ VPC ì„ íƒ (CloudPeter-VPC)
ì´ë¦„ íƒœê·¸: CloudPeter-Public-SN
ê°€ìš© ì˜ì—­: ap-northeast-2a
IPv4 CIDR ë¸”ë¡: 10.0.0.0/24
![](/images/b0f6ea91-d67f-4124-a2ab-b7e432a17df3-image.png)
3. ìƒì„± í™•ì¸
![](/images/dddcd0e4-0b0f-483e-b660-1585cc8990dd-image.png)

### ì¸í„°ë„· ê²Œì´íŠ¸ì›¨ì´ ìƒì„± ë° VPC ì—°ê²°
ì™¸ë¶€ ì¸í„°ë„· êµ¬ê°„ê³¼ í†µì‹ ì„ ìœ„í•´ IGWì„ ìƒì„±í•˜ê³  VPCì™€ ì—°ê²°

1. VPC Console ì ‘ì† -> ì¸í„°ë„· ê²Œì´íŠ¸ì›¨ì´
![](/images/d2585bd8-5971-4375-a094-f4b63ecfa5ea-image.png)
2. ì´ë¦„ íƒœê·¸: CloudPeter-IGW
![](/images/038ff117-33b8-40e6-9b93-67064fa7e92a-image.png)
3. IGWì™€ VPC ì—°ê²°
![](/images/0303ebce-9833-4e95-a3a8-4b7de36f63a4-image.png)
ì‚¬ìš© ê°€ëŠ¥í•œ VPC: ìƒì„±í•œ VPC ì„ íƒ (CloudPeter-VPC)
![](/images/201acf68-3746-4742-9421-a28b5f73cc06-image.png)
4. ì—°ê²° í™•ì¸
![](/images/001db724-5d88-4f93-b6d8-b99eedb6270f-image.png)

ì—¬ê¸°ê¹Œì§€ ì§„í–‰í–ˆë‹¤ë©´ ì¸í„°ë„·ê³¼ í†µì‹ í•˜ê¸° ìœ„í•œ IGWê°€ VPCì™€ ì—°ê²°ë˜ì—ˆê³ , ì„œë¸Œë„·ë„ ìƒì„±ëœ ìƒíƒœì´ë‹¤.
ë‹¨ ì•„ì§ ì™¸ë¶€ì¸í„°ë„·ì— ì ‘ê·¼ì€ ë¶ˆê°€ëŠ¥í•œë° VPCì˜ ê°€ìƒ ë¼ìš°íŒ… í…Œì´ë¸”ì— ì™¸ë¶€ ì¸í„°ë„·ìœ¼ë¡œ ê°€ëŠ” ë¼ìš°íŒ… ê²½ë¡œê°€ ì—†ê¸° ë•Œë¬¸ì´ë‹¤.

### í¼ë¸”ë¦­ ë¼ìš°íŒ… í…Œì´ë¸” ìƒì„± ë° ì„œë¸Œë„· ì—°ê²°

1. VPC Console ì ‘ì† -> ë¼ìš°íŒ… í…Œì´ë¸”
![](/images/f5bef8c4-c90e-4370-8f14-b24ffaf58fc5-image.png)
2. ì´ë¦„ íƒœê·¸: CloudPeter-Public-RT
VPC: ìƒì„±í•œ VPC ì„ íƒ (CloudPeter-VPC)
![](/images/78b91042-182a-4dba-9547-cfbc8eeb54a4-image.png)
3. ìƒì„± í™•ì¸ ë° ì„œë¸Œë„· ì—°ê²°
![](/images/68d0b1b0-36cd-4f22-a6ea-e769c3eb8e7c-image.png)
ì„œë¸Œë„· ì—°ê²° í´ë¦­
![](/images/1144f945-24bd-423c-99a1-5917c2d24c5e-image.png)
ì„œë¸Œë„· ì—°ê²° íŽ¸ì§‘ í´ë¦­
![](/images/c11ea166-62c1-4d49-850b-fa66e25df326-image.png)
ì „ì— ìƒì„±í•œ ì„œë¸Œë„· ì„ íƒ

### í¼ë¸”ë¦­ ë¼ìš°íŒ… í…Œì´ë¸” ê²½ë¡œ ì¶”ê°€

1. VPC Console -> ë¼ìš°íŒ… í…Œì´ë¸”
2. CloudPeter-Public-RT ì„ 
3. ë¼ìš°íŒ… íƒ­ ì§„ìž…
![](/images/09711401-bc5e-4737-8ade-6ed9edef3bd6-image.png)
4. ëŒ€ìƒ: 0.0.0.0/0
ëŒ€ìƒ: ì¸í„°ë„· ê²Œì´íŠ¸ì›¨ì´ -> igw-ì–´ì©Œê³  ì €ì©Œê³  ì„ íƒ
![](/images/8e7b9d54-eadf-43cd-a57f-0ceb6dd430c4-image.png)
5. ì ìš© í™•ì¸
![](/images/b6be05f1-b54a-490e-84e9-51ff333b3a86-image.png)

ì´ì œ ëª¨ë“  ì„¤ì •ì„ ì™„ë£Œí•˜ì˜€ìŠµë‹ˆë‹¤.
ì‹¤ì œ í†µì‹ ì´ ê°€ëŠ¥í•œì§€ ê²€ì¦í•˜ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤.

### EC2 ì¸ìŠ¤í„´ìŠ¤ ìƒì„±

í†µì‹  ì—¬ë¶€ë¥¼ í™•ì¸í•˜ê¸° ìœ„í•´ EC2 ì¸ìŠ¤í„´ìŠ¤ ìƒì„±
1. EC2 Console ì ‘ì† -> ì¸ìŠ¤í„´ìŠ¤

2. ì¸ìŠ¤í„´ìŠ¤ ì‹œìž‘ í´ë¦­
![](/images/5a95d94c-bc0d-4626-a62f-2d6315dc86b4-image.png)

3. ì´ë¦„: Public-EC2
OS ì´ë¯¸ì§€: Amazon Machine Image(AMI), 64bit, 
ì¸ìŠ¤í„´ìŠ¤ ìœ í˜•: T2.mirco
í‚¤ íŽ˜ì–´: í•­ìƒ ì‚¬ìš©í•˜ëŠ” ê·¸ê±°

4. ë„¤íŠ¸ì›Œí¬ ì„¤ì • -> íŽ¸ì§‘
![](/images/768d6c88-d81e-43d6-8bd6-7317858386fa-image.png)

5. VPC: ìƒì„±í•œ VPC ì„ íƒ (CloudPeter-VPC)
ì„œë¸Œë„·: ìƒì„±í•œ Subnet ì„ íƒ (CloudPeter-Public-SN)
í¼í”Œë¦­ IP ìžë™ í• ë‹¹: í™œì„±í™”
![](/images/3f8ec53e-0f7c-4295-af5c-772cb1780cf8-image.png)

6. ë³´ì•ˆê·¸ë£¹: default
![](/images/27954cef-a255-4cc1-99c8-f37f7e19b031-image.png)

7. ìƒì„± í™•ì¸
![](/images/00cd2548-1e35-4825-a324-2e8e3b07e853-image.png)

### EC2 ì¸ìŠ¤í„´ìŠ¤ ì ‘ê·¼ í›„ í†µì‹  í™•ì¸

í¼ë¸”ë¦­ IPë¡œ SSH ì ‘ê·¼ í›„
`ping google.com`
ë§Œì•½ í•‘ì´ ìž˜ ëœë‹¤ë©´ ì„±ê³µ!!

## ì‹¤ìŠµ - Private Subnet VPC êµ¬ì„±

#### ì‹¤ìŠµ ë‹¨ê³„

| Private Subnet ì¶”ê°€ | ê²€ì¦ |
| --- | --- |
| í”„ë¼ì´ë¹— ì„œë¸Œë„· ìƒì„± | EC2 ì¸ìŠ¤í„´ìŠ¤ ìƒì„± |
| NAT ê²Œì´íŠ¸ì›¨ì´ ìƒì„± | EC2 ì¸ìŠ¤í„´ìŠ¤ ì ‘ê·¼ í›„ í†µì‹  í™•ì¸ |
| í”„ë¼ì´ë¹— ë¼ìš°íŒ… í…Œì´ë¸” ìƒì„± ë° ì„œë¸Œë„· ì—°ê²° | í¼ë¸”ë¦­ ì„œë¸Œë„·ê³¼ í”„ë¼ì´ë¹— ì„œë¸Œë„·ì˜ í†µì‹ íë¦„ |
| í”„ë¼ì´ë¹— ë¼ìš°íŒ… í…Œì´ë¸” ê²½ë¡œ ì¶”ê°€ | |

### Private Subnet ìƒì„±

1. VPC Console ì ‘ì† -> ì„œë¸Œë„·

2. ì„œë¸Œë„· ìƒì„±
VPC ID: ìƒì„±í•œ VPC ì„ íƒ (CloudPeter-VPC)
ì´ë¦„ íƒœê·¸: CloudPeter-Private-SN
ê°€ìš© ì˜ì—­ ì„¤ì •: ap-northeast-2c
IPv4 CIDR ë¸”ë¡: 10.0.1.0/24
![](/images/447dd7cd-c68e-4397-b966-080eeecac7f2-image.png)

3. ìƒì„± í™•ì¸
![](/images/acbeabeb-f41a-4d35-a7a4-a06b56e11aa7-image.png)

### NAT ê²Œì´íŠ¸ì›¨ì´ ìƒì„±

1. VPC Console ì ‘ì† -> NAT ê²Œì´íŠ¸ì›¨ì´
![](/images/6af2950a-c904-445c-81bf-d3daf7b9c4b8-image.png)

2. ì´ë¦„: CloudPeter-NAT
ì„œë¸Œë„·: í¼í”Œë¦­ ì„œë¸Œë„· ì„ íƒ (CloudPeter-Public-SN)
íƒ„ë ¥ì  IP í• ë‹¹ í´ë¦­!
![](/images/b9e00de5-9e66-416e-903a-a6d1d73d8467-image.png)

3. ìƒì„± í™•ì¸
![](/images/6ea302a7-768f-4336-831d-f8c4111c748a-image.png)

### í”„ë¼ì´ë¹— ë¼ìš°íŒ… í…Œì´ë¸” ìƒì„± ë° ì„œë¸Œë„· ì—°ê²°

1. VPC Console ì ‘ì† -> ë¼ìš°íŒ… í…Œì´ë¸”

2. ì´ë¦„ íƒœê·¸: CloudPeter-Private-RT
VPC: ìƒì„±í•œ VPC ì„ íƒ (CloudPeter-VPC)
![](/images/e7d00c76-57f5-4e83-8677-6ef88edc38e8-image.png)

3. í”„ë¼ì´ë¹— ë¼ìš°íŒ… í…Œì´ë¸” ì„ íƒ

4. ë¼ìš°íŒ… íŽ¸ì§‘ í´ë¦­
![](/images/9358db91-15f0-49f3-ac62-bad69f38a5be-image.png)

5. í”„ë¼ì´ë¹— ì„œë¸Œë„· (CloudPeter-Private-SN) ì„ íƒ
![](/images/dffb377c-e33d-46a4-a8a8-69d43c3b88cf-image.png)


### í”„ë¼ì´ë¹— ë¼ìš°íŒ… í…Œì´ë¸” ê²½ë¡œ ì¶”ê°€


1. VPC Console ì ‘ì† -> ë¼ìš°íŒ… í…Œì´ë¸”

2. í”„ë¼ì´ë¹— ë¼ìš°íŒ… í…Œì´ë¸” ì„ íƒ

3. ë¼ìš°íŒ… íŽ¸ì§‘ í´ë¦­
![](/images/9b49470c-9bd7-4732-ad71-095303ba3cc0-image.png)
ë‹¤ìŒê³¼ ê°™ì´ íŽ¸ì§‘ (NAT ê²Œì´íŠ¸ì›¨ì´ ì„ íƒ)
![](/images/fec49ebe-9c14-4b4d-9055-2be184273abb-image.png)


### EC2 ì¸ìŠ¤í„´ìŠ¤ ìƒì„±

1. EC2 Console ì ‘ì† -> ì¸ìŠ¤í„´ìŠ¤

2. ì´ë¦„: Private-EC2
ë„¤íŠ¸ì›Œí¬: ìƒì„±í•œ VPC ì„ íƒ (CloudPeter-VPC)
ì„œë¸Œë„·: ìƒì„±í•œ í”„ë¼ì´ë¹— ì„œë¸Œë„· (CloudPeter-Private-SN)

3. ë„¤íŠ¸ì›Œí¬ ì„¤ì •
![](/images/88cbd21f-a09e-44db-9736-510684ef9b21-image.png)

4. ê³ ê¸‰ ì„¸ë¶€ ì •ë³´
![](/images/a93a7eeb-32d2-41e3-889f-b51ee48956b1-image.png)
```bash
#!/bin/bash
(
echo "qwe123"
echo "qwe123"
) | passwd --stdin root
sed -i "s/^PasswordAuthentication no/PasswordAuthentication yes/g" /etc/ssh/sshd_config
sed -i "s/^#PermitRootLogin yes/PermitRootLogin yes/g" /etc/ssh/sshd_config
service sshd restart
```
ìœ„ì— ì‚¬ìš©ìž ë°ì´í„°ëŠ” ì•”í˜¸ ë°©ì‹ìœ¼ë¡œ sshì— ì ‘ê·¼í•  ìˆ˜ ìžˆê²Œ í•˜ëŠ” ì„¤ì •ì´ë‹¤.
EC2 ì¸ìŠ¤í„´ìŠ¤ê°€ ë¶€íŒ…ë  ë•Œ ì½ì–´ì„œ ì ìš©í•œë‹¤.

5. ìƒì„± í™•ì¸
![](/images/a2caa957-0db1-431d-829a-7e2973c337fa-image.png)

Private-EC2ì˜ ë„¤íŠ¸ì›Œí¬ë¥¼ í™•ì¸í•´ë³´ë©´ í¼í”Œë¦­ ì•„ì´í”¼ê°€ ë¶€ì—¬ë˜ì§€ ì•Šì€ ê²ƒì„ í™•ì¸í•  ìˆ˜ ìžˆë‹¤.

### EC2 ì¸ìŠ¤í„´ìŠ¤ ì ‘ê·¼ í›„ í†µì‹  í™•ì¸

1. Public-EC2ì˜ IPë¡œ SSH ì ‘ì†

2. SSH ì ‘ì†í•œ ìƒíƒœì—ì„œ Private-EC2ì˜ í”„ë¼ì´ë¹— IPv4 ì£¼ì†Œë¡œ SSH ì ‘ì†
![](/images/c6a5061b-6b4e-4434-8eda-911386d55770-image.png)

3. NATë¥¼ ì´ìš©í•´ `ping google.com`ì— í•‘ì´ ê°€ëŠ”ì§€ í™•ì¸
![](/images/e1c8161d-bdb8-4d1c-b3cd-e732a9dc679b-image.png)


*NATì˜ ê²½ìš° ì•ˆì—ì„œ ë°–ìœ¼ë¡œ ë‚˜ê°€ëŠ”ê±´ ê°€ëŠ¥í•˜ì§€ë§Œ ì™¸ë¶€ì—ì„œ Private Subnetìœ¼ë¡œ ì ‘ê·¼í•˜ëŠ”ê±´ ë¶ˆê°€ëŠ¥

### ìžì› ì‚­ì œ

1. EC2 ì¸ìŠ¤í„´ìŠ¤ ì¢…ë£Œ (EC2 -> ì¸ìŠ¤í„´ìŠ¤ -> ì¸ìŠ¤í„´ìŠ¤ ì„ íƒ -> ìž‘ì—… -> ì¸ìŠ¤í„´ìŠ¤ ìƒíƒœ -> ì¢…ë£Œ)
2. NAT ê²Œì´íŠ¸ì›¨ì´ ì‚­ì œ (VPC -> NAT ê²Œì´íŠ¸ì›¨ì´ -> ìž‘ì—… -> NAT ê²Œì´íŠ¸ì›¨ì´ ì‚­ì œ)
âš ï¸ NAT ê²Œì´íŠ¸ì›¨ì´ê°€ ì‚­ì œë  ë•Œê¹Œì§€ ëŒ€ê¸°
3. íƒ„ë ¥ì  IP ì‚­ì œ (VPC -> íƒ„ë ¥ì  IP -> Actions -> íƒ„ë ¥ì  IP ì£¼ì†Œ ë¦´ë¦¬ìŠ¤)
4. VPC ì‚­ì œ (VPC -> VPC -> ìž‘ì—… -> VPC ì‚­ì œ)

